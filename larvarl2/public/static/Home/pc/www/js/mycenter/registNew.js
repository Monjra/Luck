LT.namespace("LT.registNew"),LT.registNew=function(e,n,t){e=window.ControllerSite+"/account/registerAjax",_formcfg=LT.Form.Config;var o,r,i=1;oServiceTrem=$(".serviceTrem"),registRules={rules:{Mobile:{required:!0,mobile:!0,remote:window.ControllerSite+"/account/validatemobile"},password:{required:!0,rangelength:[6,32],passwordT:!0},confirmPassword:{equalTo:$('input[name="password"]'),required:!0},securitycode:{required:!0,rangelength:[6,6],remote:window.ControllerSite+"/account/validatemobilecode"}},messages:{Mobile:{required:"您还没有填写手机号哦",mobile:"手机号码格式错误，请重新输入",remote:_formcfg.NewRemote(window.location.href.substr(window.location.href.indexOf("?returnUrl"),window.location.href.length))},password:{required:_formcfg.PasswordT,rangelength:"输入密码需在6位到32位间",passwordT:_formcfg.PasswordT},confirmPassword:{equalTo:"两次密码输入不一致，请重新输入",required:"请填写确认密码"},securitycode:{required:"请填写手机验证码",remote:"验证码错误，请重新输入",rangelength:"输入验证码需要6位"}}},r={bindEvent:function(){$(document).delegate(".loginBtn","click",function(e){if(i){$(".isxt").html("");var n=$(this).parents("form");if($("#J_phone").setRules(registRules),$("#ckfw").hasClass("checked")||$(".isxt").html("请同意必要服务协议"),n.validSubmit()){if(!$("#ckfw").hasClass("checked"))return!1;r._SubmittingForm(n)}e.preventDefault()}}),$(".J_aAgree").toggle(function(){oServiceTrem.show()},function(){oServiceTrem.hide()}),$('input[name="Moblie"]').focus(function(){$(this).parent().next().html(_formcfg.Text("手机号码"))}),$('input[name="password"]').focus(function(){var e=$('input[name="password"]').val(),n=/^[0-9]{6,32}$/,t=/^[a-zA-Z]{6,32}$/,o=/[\u4E00-\u9FA5]/,r=/^[@!#\$%&'\*\+\-\/=\?\^_`{\|}\[\]<>\(\)"~,\.:;\\]{6,32}$/,i=/^[0-9a-zA-Z@!#\$%&'\*\+\-\/=\?\^_`{\|}\[\]<>\(\)"~,\.:;\\]{6,32}$/;(n.test(e)||t.test(e)||r.test(e)||o.test(e)||!i.test(e))&&$(this).parent().next().html(_formcfg.PasswordT)}),$("form").find('[name="consent-agreement"]').click(function(){$(this).parent().toggleClass("checked")})},_SubmittingForm:function(o){var r={userName:$('input[name="Mobile"]').val(),password:encodeURIComponent($('input[name="password"]').val()),confirmPassword:encodeURIComponent($('input[name="confirmPassword"]').val()),captcha:$('input[name="securitycode"]').val(),source:void 0==$.cookie("source")?"":$.cookie("source"),UserK:UserK};i=0,$(".loginBtn").addClass("none"),$(".loginBtns").removeClass("none"),$.ajax({url:e||o.attr("action"),dataType:n||"jsonp",type:"POST",data:r,success:function(e){function n(e){if(1==e.status)location.href=t||window.ControllerSite+"/account/registSuccess.html?returnUrl="+$("#returnUrl").val();else if(0==e.status)$(".loginBtn").removeClass("none"),$(".loginBtns").addClass("none"),$(document).dialogFn({type:"alert",title:"提示",width:"300px",btnText:["确定"],content:'<div align="center" style="padding:25px 0px 25px 0px">'+e.msg+"<div>"});else if(2==e.status){$(".loginBtn").removeClass("none"),$(".loginBtns").addClass("none");var n='<i class="tip_erorr inline"></i>'+e.msg;$('[name="securitycode"]').parent().next().html(n)}}i=1,n(e)},error:function(){i=1,$(".loginBtn").removeClass("none"),$(".loginBtns").addClass("none")}})},validate:function(){$("#J_phone").validateFn(registRules,n)}},o=function(){for(var e in r)-1==e.indexOf("_")&&r[e]()}()};