function nomodelImgShow(){$(".imgTab").each(function(){if($(this).hasClass("click")){var i=$(this).attr("bigimg");"null"!=i&&null!=i&&$(".editor-main p img").attr("src",i)}});var i=$(".editor-main img").attr("src");$(".imgTab").on("click",function(){var e=$(this).attr("bigimg");$(this).attr("bigimg")!==$(".editor-main p img").attr("src")?"null"!=e&&null!=e&&$(".editor-main p img").attr("src",e):$(".editor-main p img").attr("src",i)})}function freeModelInit(){Num=1,geSuBySpecs(),chooseSize(chooseObj,designData.sizeList,designData.sizeDetail,suidWhere()?designData.suData.suId:null,function(){chooseObj.storeNum<Num?Num=chooseObj.storeNum:Num,$(".panel-number").html(Num),$(".panel-storeNum").html(chooseObj.storeNum),caculatePrice()}),chooseObj.storeNum||$("#goBuyBtn").addClass("disabled").css("background","#aaa"),loadPageSupplierInfo(),commodityListAnimate(),changeBigImg(),signcontroll(),clickSupplier(),buyNum(1,10),addShopCart(),shopCarShelfStatus(),SizeDetailDialog()}function loadPageSupplierInfo(){var i=window.supplierInfo,e="";$.each(i.policy,function(i,a){e+="<li class='fb_dd1' >		    <span><i ></i><span>"+a.policyName+"</span></span>		    <div class='ed_supernatant'><span></span>"+a.policyDescription+"</div>		</li>"}),$(".supplier_name").html(i._store_name),$(".supplier_userTel").html(i._ServicesTel),$(".supplier_StoreDesc").html(i._StoreDesc),$(".supplier_logo_url").attr("src",i._logo_url),$(".supplier_policy").html(e),$(".supplierInfoView").html(i.policyDescription)}function clickSupplier(){$("#supplierInfo").bind("click",function(){$("#companycssreInfo").removeClass("none"),supplierRating(window.supplierInfo._supplier_id)}),$("#supplierInfoClose").bind("click",function(i){$("#companycssreInfo").addClass("none"),i.stopPropagation()})}function commodityListAnimate(){$(".product_Commodity").bind("click",function(){$(".product_Commodity").removeClass("checked"),$(this).addClass("checked"),$(".product_border").addClass("none"),$(".productInfo").hasClass("checked")&&$(".productInfoView").removeClass("none"),$(".productReview").hasClass("checked")&&($(".productReviewView").removeClass("none"),$(".productReview").attr("show")||ReviewList(designData.ModelId,cpage,pagesize)),$(".supplierInfo").hasClass("checked")&&$(".supplierInfoView").removeClass("none")}),$(".commodityList li").each(function(){$(this).click(function(){$(".checkedLine").animate({left:$(this).attr("data-a")+"px"})})})}function changeBigImg(){$(".editor-main li").click(function(){var i=$(this),e=i.attr("bigimg");i.addClass("click").siblings().removeClass("click"),e&&$(".editor-main p img").attr("src",e)})}function signcontroll(){var i=$(".signboard");window.designData.isCarve&&($(".signcontentshowC").click(function(){$(this).hide(),i.slideDown(200)}),$(".signBTN").click(function(){321==window.categoryID&&"130089"!=window.supplierInfo._supplier_id?carveSubmitTX():"130083"==window.supplierInfo._supplier_id?self.carveSubmitShengBoHui():"130089"==window.supplierInfo._supplier_id&&self.carveSubmitYiSi()}),$(".signboardhide").click(function(){i.slideUp(200,function(){$(".signcontentshowC").show()})}))}function carveSubmitTX(){var i=$(".signboard"),e=i.find(".signcontent").val().trim(),a=e.split(""),t=/^[a-zA-Z\s]+$/,o=0,s=0;if(""!=e&&""!=e.trim()){if(!e.match(t))return void LT.alertSmall("请输入英文字母");for(var n=0;n<a.length;n++){if(n!=a.length-1&&" "==a[n]&&" "==a[n+1]){o=1;break}" "!=a[n]&&s++}if(o)return void LT.alertSmall("不能连续输入空格");if(s>8)return void LT.alertSmall("限8个英文字母");window.isCarveCustomer=1,LT.alertSmall("签名成功"),$(".signcontentshowC").show(),$(".signcontentshow").css("color","#b768a5"),i.slideUp(200)}else 0!=window.isCarveCustomer?(window.isCarveCustomer=0,$(".signcontentshowC").show(),$(".signcontentshow").css("color","initial"),i.slideUp(200),LT.alertSmall("取消签名")):LT.alertSmall("请输入英文字母");window.CarveContent=e,$(".signcontentshow").val(e),caculatePrice()}function carveSubmitShengBoHui(){var i=$(".signboard"),e=i.find(".signcontent").val().trim(),a=e.split(""),t=/^[a-zA-Z0-9\s]+$/,o=0,s=e.length;if(""!=e&&""!=e.trim()){if(!e.match(t))return void LT.alertSmall("请输入英文字母或数字");if(s>5)return void LT.alertSmall("限5个英文字母或数字");for(var n=0;n<a.length;n++)if(n!=a.length-1&&" "==a[n]&&" "==a[n+1]){o=1;break}if(o)return void LT.alertSmall("不能连续输入空格");window.isCarveCustomer=1,LT.alertSmall("签名成功"),$(".signcontentshowC").show(),$(".signcontentshow").css("color","#b768a5"),i.slideUp(200)}else 0!=window.isCarveCustomer?(window.isCarveCustomer=0,$(".signcontentshowC").show(),$(".signcontentshow").css("color","initial"),i.slideUp(200),LT.alertSmall("取消签名")):LT.alertSmall("请输入英文字母或数字");window.CarveContent=e,$(".signcontentshow").val(e),caculatePrice()}function carveSubmitYiSi(){var i=$(".signboard"),e=i.find(".signcontent").val().trim(),a=e.split(""),t=/^[a-zA-Z0-9\u4e00-\u9fa5\s]+$/,o=/^[\u4e00-\u9fa5]+$/,s=0;if(""!=e&&""!=e.trim()){if(!e.match(t))return void LT.alertSmall("仅支持字母、数字和汉字");for(var n=0;n<a.length;n++)o.test(a[n])?s+=2:s++;if(s>15)return void LT.alertSmall("限15个字符，1个汉字算2个字符哦~");window.isCarveCustomer=1,LT.alertSmall("签名成功"),$(".signcontentshowC").show(),$(".signcontentshow").css("color","#b768a5"),i.slideUp(200)}else 0!=window.isCarveCustomer?(window.isCarveCustomer=0,$(".signcontentshowC").show(),$(".signcontentshow").css("color","initial"),i.slideUp(200),LT.alertSmall("取消签名")):LT.alertSmall("请输入字母、数字或汉字~");window.CarveContent=e,$(".signcontentshow").val(e),caculatePrice()}function buyNum(i,e){var a=$(".panel-minus"),t=$(".panel-number"),o=$(".panel-add");a.click(function(){Num>i&&Num--,t.html(Num)}),o.click(function(){chooseObj.storeNum<e?Num<chooseObj.storeNum&&Num++:e>Num&&Num++,t.html(Num)})}function addShopCart(){$("#goBuyBtn").click(function(){var i=$(this);return i.hasClass("disabled")?!1:i.hasClass("masked")?!1:($(this).addClass("masked"),chooseObj.suId?void addToShopCart(i):(i.removeClass("masked"),void LT.alertSmall("请选择规格！")))})}function addToShopCart(i){var e="http://buy.biyao.com",a={halitus:[],sign:[]};window.isCarveCustomer&&a.sign.push({sm:0,pr:designData.productId});var t={su:chooseObj.suId,model:0,supplier:designData.supplierInfo._supplier_id,"package":0,num:Num,payStatus:"0",f_code:"",extendInfo:window.isCarveCustomer?'{"productSigns": [{"carve_id": '+designData.carveInfo.carveId+',"carve_content": "'+window.CarveContent+'"}]}':"{}",performExtends:JSON.stringify(a)};$.ajax({type:"POST",url:e+"/shopcars/addshopcar?",data:t,async:!1,cache:!1,dataType:"jsonp",success:function(a){return i&&i.removeClass("masked"),205017==a?void LT.alertSmall("非常抱歉，原材料不足"):220001==a?void LT.alertSmall("F码无效，请核对后重新输入"):220002==a?void LT.alertSmall("F码已失效"):220003==a?void LT.alertSmall("F码已失效"):220004==a?void LT.alertSmall("F码不能重复使用"):230001==a?void LT.alertSmall("非常抱歉，购买数量超过了剩余数量"):1e5==a?void LT.alertSmall("系统异常"):a?void(window.location.href=e+"/shopcars/index.html"):void LT.alertSmall("购买失败")},error:function(){i&&i.removeClass("masked"),LT.alertSmall("网络异常，购买失败")},complete:function(){i&&i.removeClass("masked")}})}function caculatePrice(){var i=chooseObj.price?chooseObj.price:designData.suData.price,e=chooseObj.duration?chooseObj.duration:designData.suData.duration;window.isCarveCustomer&&(i+=designData.carveInfo.price,e+=designData.carveInfo.duration),$(".totalPrice").html(i),$(".totalDuration").html(e)}function shopCarShelfStatus(){1!=designData.shelfStatus&&$("#goBuyBtn").addClass("disabled").html("<i></i>商品已下架").css("background","#aaa")}function SizeDetailDialog(){var i=$("#SizeDetailDialog");designData.suData.sizeDetail?($("body").append("<img class='none' src='"+designData.suData.sizeDetail+"'>"),i.click(function(){$(this).dialogFn({type:"alert",title:"尺码对照表",width:"560px",btnshow:!1,content:"<img width='560' id='SizeDetailIMG' src='"+designData.suData.sizeDetail+"'>"})})):i.remove()}$(function(){freeModelInit(),document.title=window.designData.suData.suName,nomodelImgShow()});